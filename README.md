# API-DEMO
A quick demonstartion of an API using spring boot and swagger

## Compile

This is intended to be compiled using java 17 at a minimum

```
$ mvn clean install
```

## Run

In the target directory

```
$ java -jar api-demo*.jar
```
## Configuration

Configuration is in the internal __application.properties__ file

server.port is set to 8081

## Swagger

Swagger is an automatically generated application that descibes API facilities
and allows testing of them; it is available at
```
localhost:8081/swagger-ui/
```

## How it works

The main is in __uk.co.rpl.exampleapi.DemoApplication__

### Controllers

There are two controllers

* __uk.co.rpl.exampleapi.controllers.HomeController__
* __uk.co.rpl.exampleapi.controllers.UserController__

and 1 exception handler
* __uk.co.rpl.exampleapi.controllers.ExceptionHandlers__

__HomeController__ only redirects / to swagger documentation, so Swagger docs should be found at __http://localhost:8081/__,
if you have not seen Swagger before it is an excellent way of automatically documenting an api, much more information
can be displayed than done here through a whole range of annotations.

__UserController__ provides information about Users, there are within it a fixed list of 4 users, 
the controller routes three end points:

* __/api/user/{id}__ Get user identified by index 0 to 3 i.e. __/api/user/3__.
* __/api/main-user__ Get the first user, this is equivalent to __/api/user/0__.
* __/api/users__ This returns a list of all 4 users

In all cases the returned data for a User is just  the two fields __firstName__ and __lastName__.

__ExceptionHandler__ processes exceptions that are not caught before they leave the controllers.

It is marked with the annotation __@ControllerAdvice__ which indicates special controller configuration.

It only contains a single Handler which handles the NotFound exception thrown from the __UserService's__
__get(int id)__ method and hence from the __/api/user/{id}__ end point if id is out of bounds.

### Testing

Testing uses __Junit5__ sometimes called __Junit Jupiter__ as it is a completely rewritten version of __JUnit__.

Test methods are annoted with __@Test__, a method annotated with __@BeforeEach__ will be run before test method.

There are 3 test classes
* __DemoApplicationTests__ only tests that the application does not fail to start up, and was autogenerated by InteliJ.
* __UserControllerTest__ tests the user controller, this uses the spring class __MockMvc__ to mock the invocation of the 
__UserController__ as spring would whilst it is running.

In general the __perform__ method of __MockMvc__ take a url, you can also specify headers and a body, though 
only the url is used in these cases.

The perform method returns a ResultActions class, you can use __andExpect__ to test various aspects of the result.

* __UserServiceTest__ tests the user service class, each __@Test__ method executes one of the methods in __UserService__
and then tests for correctness the returned data.
